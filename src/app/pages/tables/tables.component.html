<div class="tables-page">
  <!-- Controls section -->
  <section class="controls-section">
    <div class="control-card">
      <div class="control-header">
        <svg class="control-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <path d="M12 2v20M2 12h20"/>
        </svg>
        <span>Th√™m nh√≥m m·ªõi</span>
      </div>
      <div class="input-group">
        <input [(ngModel)]="newGroupName" placeholder="Nh·∫≠p t√™n nh√≥m..." class="modern-input">
        <button (click)="createGroup()" class="btn-primary">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <path d="M12 5v14M5 12h14"/>
          </svg>
          T·∫°o nh√≥m
        </button>
      </div>
    </div>
    
    <div class="control-card filter-card">
      <div class="control-header">
        <svg class="control-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"/>
        </svg>
        <span>L·ªçc theo nh√≥m</span>
      </div>
      <select [(ngModel)]="selectedGroupId" (ngModelChange)="onGroupChange($event)" class="modern-select">
        <option [value]="0">üìã T·∫•t c·∫£ c√°c b√†n</option>
        <option *ngFor="let g of groups" [value]="g.id">üè∑Ô∏è {{ g.name }}</option>
      </select>
    </div>
  </section>

  <!-- Groups and tables -->
  <section *ngFor="let g of visibleGroups; trackBy: trackByGroupId" class="group-container">
    <div class="group-header">
      <div class="group-title">
        <div class="group-icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <path d="M4 19.5A2.5 2.5 0 016.5 17H20"/>
            <path d="M6.5 2H20v20H6.5A2.5 2.5 0 014 19.5v-15A2.5 2.5 0 016.5 2z"/>
          </svg>
        </div>
        <h2>{{ g.name }}</h2>
        <span class="table-count">{{ g.tables.length }} b√†n</span>
      </div>
      
      <div class="add-table-section">
        <input [(ngModel)]="newTableName" placeholder="T√™n b√†n m·ªõi..." class="table-input">
        <button (click)="createTable(g.id)" class="btn-add-table">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <path d="M12 5v14M5 12h14"/>
          </svg>
          Th√™m b√†n
        </button>
      </div>
    </div>

    <div class="tables-grid">
      <div class="table-card" *ngFor="let t of g.tables" (click)="openTable(t)" [attr.data-status]="t.status">
        <div class="table-card-inner">
          <div class="table-header">
            <h3 class="table-name">{{ t.name }}</h3>
            <div class="table-status-badge" [attr.data-status]="t.status">
              <span class="status-dot"></span>
              <span class="status-text">{{ getStatusText(t.status) }}</span>
            </div>
          </div>
          
          <div class="table-info">
            <div class="info-row">
              <span class="info-label">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                  <path d="M20 21v-2a4 4 0 00-4-4H8a4 4 0 00-4 4v2"/>
                  <circle cx="12" cy="7" r="4"/>
                </svg>
                Kh√°ch h√†ng
              </span>
              <span class="info-value" [class.empty]="!t.customerName">
                <ng-container *ngIf="t.status === 'serving'">
                  {{ t.customerName || 'Kh√°ch l·∫ª' }}
                </ng-container>
                <ng-container *ngIf="t.status !== 'serving'">
                  {{ t.customerName || 'Ch∆∞a c√≥' }}
                </ng-container>
              </span>
            </div>
            
            <div class="info-row">
              <span class="info-label">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                  <path d="M22 16.92v3a2 2 0 01-2.18 2 19.79 19.79 0 01-8.63-3.07 19.5 19.5 0 01-6-6 19.79 19.79 0 01-3.07-8.67A2 2 0 014.11 2h3a2 2 0 012 1.72 12.84 12.84 0 00.7 2.81 2 2 0 01-.45 2.11L8.09 9.91a16 16 0 006 6l1.27-1.27a2 2 0 012.11-.45 12.84 12.84 0 002.81.7A2 2 0 0122 16.92z"/>
                </svg>
                SƒêT
              </span>
              <span class="info-value" [class.empty]="!t.customerPhone">
                {{ t.customerPhone || 'Ch∆∞a c√≥' }}
              </span>
            </div>
            
            <div class="info-row">
              <span class="info-label">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
                  <line x1="16" y1="2" x2="16" y2="6"/>
                  <line x1="8" y1="2" x2="8" y2="6"/>
                  <line x1="3" y1="10" x2="21" y2="10"/>
                </svg>
                Ng√†y b·∫Øt ƒë·∫ßu
              </span>
              <span class="info-value" [class.empty]="!t.startDate" [class.live]="t.status === 'serving'">
                {{ t.startDate ? (t.startDate | date:'dd/MM/yyyy') : 'Ch∆∞a m·ªü' }}
              </span>
            </div>
            
            <div class="info-row">
              <span class="info-label">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                  <line x1="12" y1="1" x2="12" y2="23"/>
                  <path d="M17 5H9.5a3.5 3.5 0 000 7h5a3.5 3.5 0 010 7H6"/>
                </svg>
                Th√†nh ti·ªÅn
              </span>
              <span class="info-value amount" 
                    [class.empty]="!t.totalAmount || t.totalAmount === 0"
                    [class.live]="t.status === 'serving' && t.totalAmount && t.totalAmount > 0">
                {{ t.totalAmount ? (t.totalAmount | number:'1.0-0') + 'ƒë' : '0ƒë' }}
              </span>
            </div>
          </div>
          
          <div class="table-actions">
            <button *ngIf="t.status === 'empty'" (click)="openTable(t); $event.stopPropagation()" class="btn-action empty">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <path d="M15 3h4a2 2 0 012 2v14a2 2 0 01-2 2h-4M10 17l5-5-5-5M3 12h12"/>
              </svg>
              M·ªü b√†n
            </button>
            
            <button *ngIf="t.status === 'reserved'" (click)="confirmReserved(t); $event.stopPropagation()" class="btn-action reserved">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <polyline points="20 6 9 17 4 12"/>
              </svg>
              X√°c nh·∫≠n kh√°ch t·ªõi
            </button>
            
            <button *ngIf="t.status === 'serving'" (click)="openTable(t); $event.stopPropagation()" class="btn-action serving">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <circle cx="12" cy="12" r="10"/>
                <polyline points="12 6 12 12 16 14"/>
              </svg>
              Xem chi ti·∫øt
            </button>
          </div>
        </div>
      </div>
    </div>
  </section>
</div>